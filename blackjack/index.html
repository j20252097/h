<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ãƒ–ãƒ©ãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚¯</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
  <style>
    body { background:#121212; color:#fff; }
    main.container { padding:2rem; }
    .hand { margin:1rem 0; display:flex; gap:0.5rem; }
    .card {
      background:#fff; color:#000; padding:1rem;
      border-radius:8px; width:50px; text-align:center;
      font-weight:bold; font-size:1.2rem;
    }
    .hidden { background:#444 !important; color:#444 !important; }
    #log { margin-top:1rem; white-space:pre-line; }
    #adminPanel { display:none; margin-top:2rem; padding:1rem; border:1px solid #666; border-radius:8px; }
  </style>
</head>
<body>
  <nav class="container-fluid">
    <ul><li><strong>ãƒ–ãƒ©ãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚¯</strong></li></ul>
    <ul>
      <li><a href="#">Home</a></li>
      <li><a href="#">ãƒ«ãƒ¼ãƒ«</a></li>
    </ul>
  </nav>

  <main class="container">
    <h2>ãƒ–ãƒ©ãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚¯ã‚²ãƒ¼ãƒ </h2>
    <p>æ‰€æŒã‚³ã‚¤ãƒ³: <span id="coins"></span></p>
    <label>ãƒ™ãƒƒãƒˆé¡: <input type="number" id="bet" min="1" value="10"></label>
    <button onclick="startGame()">ğŸ² ã‚²ãƒ¼ãƒ é–‹å§‹</button>

    <h3>ãƒ‡ã‚£ãƒ¼ãƒ©ãƒ¼ã®æ‰‹æœ­</h3>
    <div id="dealerHand" class="hand"></div>

    <h3>ã‚ãªãŸã®æ‰‹æœ­</h3>
    <div id="playerHand" class="hand"></div>

    <div>
      <button onclick="hit()" id="hitBtn" disabled>ãƒ’ãƒƒãƒˆ</button>
      <button onclick="stand()" id="standBtn" disabled>ã‚¹ã‚¿ãƒ³ãƒ‰</button>
    </div>

    <pre id="log"></pre>

    <h3>ç®¡ç†è€…ã‚³ãƒãƒ³ãƒ‰</h3>
    <input type="password" id="adminPassword" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å…¥åŠ›">
    <button onclick="checkAdmin()">ãƒ­ã‚°ã‚¤ãƒ³</button>

    <div id="adminPanel">
      <h4>ã‚³ã‚¤ãƒ³ç®¡ç†ãƒ‘ãƒãƒ«</h4>
      <label>ã‚³ã‚¤ãƒ³æ•°: <input type="number" id="adminCoins"></label>
      <button onclick="updateCoins()">æ›´æ–°</button>
    </div>
  </main>

<script>
  const suits = ["â™ ", "â™¥", "â™¦", "â™£"];
  const ranks = ["A","2","3","4","5","6","7","8","9","10","J","Q","K"];
  let deck, dealerHand, playerHand, coins, bet;
  let dealerHidden = true;

  // åˆæœŸã‚³ã‚¤ãƒ³èª­ã¿è¾¼ã¿
  coins = parseInt(localStorage.getItem("coins")) || 1000;
  document.getElementById("coins").innerText = coins;

  function saveCoins() {
    localStorage.setItem("coins", coins);
    document.getElementById("coins").innerText = coins;
  }

  function createDeck() {
    let d = [];
    for (let s of suits) {
      for (let r of ranks) {
        d.push({suit:s, rank:r});
      }
    }
    return d.sort(() => Math.random()-0.5);
  }

  function cardValue(card) {
    if (["J","Q","K"].includes(card.rank)) return 10;
    if (card.rank === "A") return 11; 
    return parseInt(card.rank);
  }

  function handValue(hand) {
    let total = 0, aces = 0;
    for (let c of hand) {
      total += cardValue(c);
      if (c.rank === "A") aces++;
    }
    while (total > 21 && aces > 0) {
      total -= 10;
      aces--;
    }
    return total;
  }

  function renderHand(elementId, hand, hideFirst=false) {
    const el = document.getElementById(elementId);
    el.innerHTML = "";
    hand.forEach((c,i)=>{
      const div = document.createElement("div");
      div.className = "card";
      if (i===0 && hideFirst) {
        div.classList.add("hidden");
        div.innerText = "ï¼Ÿ";
      } else {
        div.innerText = c.rank + c.suit;
      }
      el.appendChild(div);
    });
  }

  function log(msg) {
    document.getElementById("log").innerText += msg + "\n";
  }

  function startGame() {
    bet = parseInt(document.getElementById("bet").value);
    if (bet > coins) { alert("ã‚³ã‚¤ãƒ³ä¸è¶³ï¼"); return; }
    coins -= bet; saveCoins();

    deck = createDeck();
    dealerHand = [deck.pop(), deck.pop()];
    playerHand = [deck.pop(), deck.pop()];
    dealerHidden = true;

    document.getElementById("log").innerText = "";
    renderHand("dealerHand", dealerHand, true);
    renderHand("playerHand", playerHand, false);

    document.getElementById("hitBtn").disabled = false;
    document.getElementById("standBtn").disabled = false;

    if (handValue(playerHand) === 21) {
      endGame(true, true);
    }
  }

  function hit() {
    playerHand.push(deck.pop());
    renderHand("playerHand", playerHand);
    if (handValue(playerHand) > 21) {
      endGame(false);
    }
  }

  function stand() {
    dealerHidden = false;
    while (handValue(dealerHand) < 17) {
      dealerHand.push(deck.pop());
    }
    endGame();
  }

  function endGame(playerBlackjack=false) {
    dealerHidden = false;
    renderHand("dealerHand", dealerHand, false);
    let playerVal = handValue(playerHand);
    let dealerVal = handValue(dealerHand);

    if (playerBlackjack) {
      if (handValue(dealerHand) === 21) {
        log("å¼•ãåˆ†ã‘ï¼ï¼ˆä¸¡è€…ãƒ–ãƒ©ãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚¯ï¼‰");
        coins += bet; 
      } else {
        log("ãƒ–ãƒ©ãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚¯ï¼å‹ã¡ï¼");
        coins += bet * 2.5;
      }
      saveCoins();
      return;
    }

    if (playerVal > 21) {
      log("ãƒã‚¹ãƒˆï¼è² ã‘");
    } else if (dealerVal > 21 || playerVal > dealerVal) {
      log("å‹ã¡ï¼");
      coins += bet * 2;
    } else if (playerVal === dealerVal) {
      log("ãƒ—ãƒƒã‚·ãƒ¥ï¼ˆå¼•ãåˆ†ã‘ï¼‰");
      coins += bet;
    } else {
      log("è² ã‘");
    }

    saveCoins();
    document.getElementById("hitBtn").disabled = true;
    document.getElementById("standBtn").disabled = true;
  }

  // ç®¡ç†è€…æ©Ÿèƒ½
  function checkAdmin() {
    const pw = document.getElementById("adminPassword").value;
    if (pw === "20252097") {
      document.getElementById("adminPanel").style.display = "block";
      document.getElementById("adminCoins").value = coins;
    } else {
      alert("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™");
    }
  }

  function updateCoins() {
    coins = parseInt(document.getElementById("adminCoins").value);
    saveCoins();
    alert("ã‚³ã‚¤ãƒ³æ•°ã‚’æ›´æ–°ã—ã¾ã—ãŸï¼");
  }
</script>
</body>
</html>
