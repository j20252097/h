<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Multi Tool</title>
  <link rel="icon" href="https://raw.githubusercontent.com/j20252097/h/refs/heads/main/1718374862947-Di6UorBBZD.webp">
  <style>
    body {
      margin: 0;
      font-family: "Segoe UI", sans-serif;
      background-color: #121212;
      color: #fff;
      text-align: center;
    }

    header {
      padding: 2rem 1rem;
    }

    h1, h2 {
      color: #1db954;
      margin-bottom: 1rem;
    }

    .spotify-btn {
      background-color: #1db954;
      border: none;
      color: #fff;
      padding: 1rem 2rem;
      font-size: 1.1rem;
      border-radius: 50px;
      cursor: pointer;
      transition: background 0.3s ease;
      margin: 0.3rem;
    }
    .spotify-btn:hover {
      background-color: #17a74a;
    }

    section {
      display: none;
      margin: 2rem auto;
      max-width: 900px;
      padding: 1rem;
    }
    section.active {
      display: block;
    }

    /* ç”»åƒç”Ÿæˆ */
    #generate-btn {
      background: #1db954;
      color: #fff;
      cursor: pointer;
      border-radius: 30px;
      padding: 0.6rem 1.2rem;
    }
    #generate-btn:hover {
      background: #17a74a;
    }

    .frame {
      margin: 1.5rem auto;
      padding: 10px;
      border: 5px solid #1db954;
      border-radius: 12px;
      max-width: 90%;
      background: #000;
      box-shadow: 0 0 20px rgba(29, 185, 84, 0.5);
      min-height: 200px;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .frame img {
      width: 100%;
      height: auto;
      max-height: 70vh;
      object-fit: contain;
      border-radius: 8px;
    }
    .loading {
      color: #1db954;
      font-size: 1.2rem;
      font-weight: bold;
      animation: blink 1.5s infinite;
    }
    @keyframes blink { 50% { opacity: 0.5; } }

    /* é›»å“ */
    .calculator {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      max-width: 400px;
      margin: 0 auto;
    }
    .calc-display {
      grid-column: span 4;
      background: #000;
      color: #1db954;
      font-size: 2rem;
      padding: 1rem;
      text-align: right;
      border-radius: 8px;
      overflow-x: auto;
      box-shadow: inset 0 0 10px rgba(29, 185, 84, 0.4);
    }
    .calc-display[contenteditable="true"] {
      outline: none;
      cursor: text;
    }
    .calc-btn {
      background: #282828;
      color: #fff;
      border: none;
      padding: 1.2rem;
      font-size: 1.2rem;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.2s ease;
    }
    .calc-btn:hover {
      background: #1db954;
      color: #000;
    }
    .calc-btn.operator {
      background: #444;
    }
    .calc-btn.operator:hover {
      background: #666;
      color: #fff;
    }

    /* ãƒ¡ãƒ¢ */
    #memo textarea {
      width: 90%;
      max-width: 600px;
      padding: 0.6rem;
      border-radius: 8px;
      border: 1px solid #1db954;
      background: #000;
      color: #fff;
    }
    #memo-list div {
      border: 1px solid #1db954;
      padding: 10px;
      margin: 10px auto;
      border-radius: 8px;
      background: #181818;
      max-width: 600px;
      text-align: left;
    }
    #memo-list img {
      max-width: 100%;
      margin-top: 8px;
      border-radius: 6px;
    }

    @media (max-width: 768px) {
      h1, h2 { font-size: 1.4rem; }
      .spotify-btn {
        width: 80%;
        font-size: 1rem;
        padding: 0.8rem 1rem;
      }
      .frame { max-width: 95%; }
      .calc-display { font-size: 1.5rem; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Multi Tool</h1>
    <button class="spotify-btn" onclick="showSection('image-generator')">ç”»åƒç”Ÿæˆ</button>
    <button class="spotify-btn" onclick="showSection('calculator')">é›»å“</button>
    <button class="spotify-btn" onclick="showSection('memo')">ãƒ¡ãƒ¢</button>
  </header>

  <!-- === ç”»åƒç”Ÿæˆæ©Ÿèƒ½ã‚¨ãƒªã‚¢ === -->
  <section id="image-generator">
    <h2>ç”»åƒç”Ÿæˆï¼ˆR-18ï¼‰</h2>
    <div class="controls">
      <select id="category">
        <option value="hentai">Hentai</option>
        <option value="boobs">Boobs</option>
        <option value="paizuri">Paizuri</option>
        <option value="anal">Anal</option>
        <option value="pussy">Pussy</option>
        <option value="gonewild">Gonewild</option>
        <option value="ass">Ass</option>
        <option value="4k">4K</option>
        <option value="hanal">Hentai Anal</option>
        <option value="pgif">Hentai GIF</option>
      </select>
      <button id="generate-btn" onclick="generateImage()">ç”Ÿæˆ</button>
    </div>
    <div class="frame" id="image-frame" style="display:none;">
      <span class="loading" id="loading-text" style="display:none;">ç”»åƒç”Ÿæˆä¸­...</span>
      <img id="generated-img" src="" alt="ç”Ÿæˆç”»åƒ" style="display:none;">
    </div>
    <button class="spotify-btn" onclick="showSection('home')">æ©Ÿèƒ½é¸æŠã«æˆ»ã‚‹</button>
  </section>

  <!-- === é›»å“æ©Ÿèƒ½ã‚¨ãƒªã‚¢ === -->
  <section id="calculator">
    <h2>é–¢æ•°é›»å“</h2>
    <div class="calculator">
      <div class="calc-display" id="calc-display" contenteditable="true">0</div>
      <button class="calc-btn operator" onclick="clearDisplay()">AC</button>
      <button class="calc-btn operator" onclick="deleteChar()">âŒ«</button>
      <button class="calc-btn operator" onclick="square()">xÂ²</button>
      <button class="calc-btn operator" onclick="insert('/')">Ã·</button>
      <button class="calc-btn" onclick="insert('7')">7</button>
      <button class="calc-btn" onclick="insert('8')">8</button>
      <button class="calc-btn" onclick="insert('9')">9</button>
      <button class="calc-btn operator" onclick="insert('*')">Ã—</button>
      <button class="calc-btn" onclick="insert('4')">4</button>
      <button class="calc-btn" onclick="insert('5')">5</button>
      <button class="calc-btn" onclick="insert('6')">6</button>
      <button class="calc-btn operator" onclick="insert('-')">-</button>
      <button class="calc-btn" onclick="insert('1')">1</button>
      <button class="calc-btn" onclick="insert('2')">2</button>
      <button class="calc-btn" onclick="insert('3')">3</button>
      <button class="calc-btn operator" onclick="insert('+')">+</button>
      <button class="calc-btn" onclick="insert('0')">0</button>
      <button class="calc-btn" onclick="insert('.')">.</button>
      <button class="calc-btn operator" onclick="calculate()">=</button>
      <button class="calc-btn operator" onclick="insert('sqrt()')">âˆš</button>
      <button class="calc-btn operator" onclick="insert('sin()')">sin</button>
      <button class="calc-btn operator" onclick="insert('cos()')">cos</button>
      <button class="calc-btn operator" onclick="insert('tan()')">tan</button>
      <button class="calc-btn operator" onclick="insert('log()')">log</button>
    </div>
    <button class="spotify-btn" onclick="showSection('home')">æ©Ÿèƒ½é¸æŠã«æˆ»ã‚‹</button>
  </section>

  <!-- === ãƒ¡ãƒ¢æ©Ÿèƒ½ã‚¨ãƒªã‚¢ === -->
  <section id="memo">
    <h2>ãƒ¡ãƒ¢</h2>
    <textarea id="memo-text" placeholder="ã“ã“ã«ãƒ¡ãƒ¢ã‚’æ›¸ã„ã¦ãã ã•ã„..." rows="4"></textarea><br>
    <input type="file" id="memo-image" accept="image/*"><br><br>
    <button class="spotify-btn" onclick="saveMemo()">ä¿å­˜</button>
    <div id="memo-list"></div>
    <button class="spotify-btn" onclick="showSection('home')">æ©Ÿèƒ½é¸æŠã«æˆ»ã‚‹</button>
  </section>

  <script>
    // --- å…±é€šã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆ ---
    function showSection(id) {
      document.querySelectorAll("section").forEach(sec => sec.classList.remove("active"));
      if (id === "home") {
        document.querySelector("header").style.display = "block";
      } else {
        document.querySelector("header").style.display = "none";
        document.getElementById(id).classList.add("active");
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
    }

    // --- ç”»åƒç”Ÿæˆ ---
    async function generateImage() {
      const category = document.getElementById("category").value;
      const img = document.getElementById("generated-img");
      const frame = document.getElementById("image-frame");
      const loading = document.getElementById("loading-text");

      frame.style.display = "flex";
      img.style.display = "none";
      loading.style.display = "block";

      try {
        const res = await fetch(`https://nekobot.xyz/api/image?type=${category}`);
        const data = await res.json();
        if (data && data.message) {
          img.src = data.message;
          img.onload = () => {
            loading.style.display = "none";
            img.style.display = "block";
          };
        } else {
          loading.textContent = "ç”»åƒã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚";
        }
      } catch (err) {
        console.error("ç”»åƒå–å¾—ã‚¨ãƒ©ãƒ¼:", err);
        loading.textContent = "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚";
      }
    }

    // --- é›»å“ ---
    function insert(val) {
      const display = document.getElementById("calc-display");
      if (display.innerText === "0") display.innerText = "";
      if (val.includes("()")) {
        display.innerText += val;
        const range = document.createRange();
        const sel = window.getSelection();
        range.setStart(display.childNodes[0], display.innerText.length - 1);
        range.setEnd(display.childNodes[0], display.innerText.length - 1);
        sel.removeAllRanges();
        sel.addRange(range);
      } else {
        display.innerText += val;
      }
    }
    function clearDisplay() {
      document.getElementById("calc-display").innerText = "0";
    }
    function deleteChar() {
      const display = document.getElementById("calc-display");
      display.innerText = display.innerText.slice(0, -1) || "0";
    }
    function square() {
      const display = document.getElementById("calc-display");
      display.innerText += "**2";
    }
    function calculate() {
      const display = document.getElementById("calc-display");
      try {
        let expr = display.innerText
          .replace(/\^/g, "**")
          .replace(/sqrt\(/g, "Math.sqrt(")
          .replace(/sin\(/g, "Math.sin(")
          .replace(/cos\(/g, "Math.cos(")
          .replace(/tan\(/g, "Math.tan(")
          .replace(/log\(/g, "Math.log(");
        display.innerText = eval(expr);
      } catch {
        display.innerText = "ã‚¨ãƒ©ãƒ¼";
      }
    }

    // --- ãƒ¡ãƒ¢ ---
    let memos = JSON.parse(localStorage.getItem("memos") || "[]");
    let editIndex = null;

    function saveMemo() {
      const text = document.getElementById("memo-text").value;
      const file = document.getElementById("memo-image").files[0];
      if (!text && !file) return alert("ãƒ¡ãƒ¢å†…å®¹ãŒç©ºã§ã™");

      if (file) {
        const reader = new FileReader();
        reader.onload = () => {
          if (editIndex !== null) {
            memos[editIndex] = { text, image: reader.result };
            editIndex = null;
          } else {
            memos.unshift({ text, image: reader.result }); // æ–°ã—ã„ã®ã‚’ä¸Šã«è¿½åŠ 
          }
          localStorage.setItem("memos", JSON.stringify(memos));
          renderMemos();
        };
        reader.readAsDataURL(file);
      } else {
        if (editIndex !== null) {
          memos[editIndex] = { text, image: memos[editIndex].image };
          editIndex = null;
        } else {
          memos.unshift({ text, image: null }); // æ–°ã—ã„ã®ã‚’ä¸Šã«è¿½åŠ 
        }
        localStorage.setItem("memos", JSON.stringify(memos));
        renderMemos();
      }
      document.getElementById("memo-text").value = "";
      document.getElementById("memo-image").value = "";
    }

    function renderMemos() {
      const list = document.getElementById("memo-list");
      list.innerHTML = "";
      memos.forEach((memo, i) => {
        const div = document.createElement("div");
        div.innerHTML = `
          <p>${memo.text || ""}</p>
          ${memo.image ? `<img src="${memo.image}">` : ""}
          <div style="margin-top:8px;">
            <button class="spotify-btn" style="padding:0.3rem 1rem; font-size:0.9rem;" onclick="editMemo(${i})">âœï¸ ç·¨é›†</button>
            <button class="spotify-btn" style="padding:0.3rem 1rem; font-size:0.9rem;" onclick="shareMemo(${i})">ğŸ”— å…±æœ‰</button>
            <button class="spotify-btn" style="padding:0.3rem 1rem; font-size:0.9rem; background:#b91d1d;" onclick="deleteMemo(${i})">ğŸ—‘ï¸ å‰Šé™¤</button>
          </div>
        `;
        list.appendChild(div);
      });
    }

    function editMemo(index) {
      document.getElementById("memo-text").value = memos[index].text || "";
      editIndex = index;
      alert("ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«ãªã‚Šã¾ã—ãŸã€‚ä¿®æ­£å¾Œã«ä¿å­˜ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚");
    }

    function deleteMemo(index) {
      if (!confirm("ã“ã®ãƒ¡ãƒ¢ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")) return;
      memos.splice(index, 1);
      localStorage.setItem("memos", JSON.stringify(memos));
      renderMemos();
    }

    function shareMemo(index) {
      const memo = memos[index];
      const encoded = encodeURIComponent(btoa(JSON.stringify(memo)));
      const url = `${location.origin}${location.pathname}?shared=${encoded}`;
      navigator.clipboard.writeText(url).then(() => {
        alert("ã“ã®ãƒ¡ãƒ¢ã‚’å…±æœ‰URLã¨ã—ã¦ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ:\n" + url);
      });
    }

    window.addEventListener("DOMContentLoaded", () => {
      const params = new URLSearchParams(location.search);
      if (params.has("shared")) {
        try {
          const memo = JSON.parse(atob(decodeURIComponent(params.get("shared"))));
          memos.unshift(memo);
          localStorage.setItem("memos", JSON.stringify(memos));
          alert("å…±æœ‰ã•ã‚ŒãŸãƒ¡ãƒ¢ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸï¼");
        } catch {
          alert("å…±æœ‰ãƒ¡ãƒ¢ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");
        }
      }
      renderMemos();
    });
  </script>
</body>
</html>
